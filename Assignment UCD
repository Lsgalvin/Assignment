{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "76e08493-bf0b-484a-9197-1a188831fd53",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>COMPLETION_DATE</th>\n",
       "      <th>USD_AMOUNT</th>\n",
       "      <th>ACCOUNT_CURRENCY</th>\n",
       "      <th>PAYSYSTEM</th>\n",
       "      <th>GATEWAY</th>\n",
       "      <th>ROLLBACK</th>\n",
       "      <th>OVERCREDIT</th>\n",
       "      <th>FINAL_STATUS</th>\n",
       "      <th>ATAS_SCREENING</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>OUTCOME_POST_M</th>\n",
       "      <th>HOST_OUTCOME_POST_M</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>63786440</td>\n",
       "      <td>0</td>\n",
       "      <td>2680739487</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>11.26</td>\n",
       "      <td>EUR</td>\n",
       "      <td>TAX</td>\n",
       "      <td>ADMIN</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>113590940</td>\n",
       "      <td>0</td>\n",
       "      <td>2680726130</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>0</td>\n",
       "      <td>CAD</td>\n",
       "      <td>DIRBANK</td>\n",
       "      <td>GCash</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>130060541</td>\n",
       "      <td>0</td>\n",
       "      <td>2680728142</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>137.43</td>\n",
       "      <td>GBP</td>\n",
       "      <td>MASTERCARD</td>\n",
       "      <td>WORLDPAY_WPG</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>59425843</td>\n",
       "      <td>0</td>\n",
       "      <td>2680719397</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>9.88</td>\n",
       "      <td>EUR</td>\n",
       "      <td>TAX</td>\n",
       "      <td>ADMIN</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>95610708</td>\n",
       "      <td>0</td>\n",
       "      <td>2680727257</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>411.99</td>\n",
       "      <td>EUR</td>\n",
       "      <td>PAYPAL</td>\n",
       "      <td>PAYPALDIRECT</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   USERINTID  VIP_STATUS     TRANSID COMPLETION_DATE  USD_AMOUNT   \\\n",
       "0   63786440           0  2680739487      25/07/2021        11.26   \n",
       "1  113590940           0  2680726130      25/07/2021            0   \n",
       "2  130060541           0  2680728142      25/07/2021       137.43   \n",
       "3   59425843           0  2680719397      25/07/2021         9.88   \n",
       "4   95610708           0  2680727257      25/07/2021       411.99   \n",
       "\n",
       "  ACCOUNT_CURRENCY   PAYSYSTEM       GATEWAY ROLLBACK OVERCREDIT FINAL_STATUS  \\\n",
       "0              EUR         TAX         ADMIN       No        Yes            A   \n",
       "1              CAD     DIRBANK         GCash       No        Yes            A   \n",
       "2              GBP  MASTERCARD  WORLDPAY_WPG      Yes         No            A   \n",
       "3              EUR         TAX         ADMIN       No        Yes            A   \n",
       "4              EUR      PAYPAL  PAYPALDIRECT       No        Yes            A   \n",
       "\n",
       "  ATAS_SCREENING RISK ATAS_RULE STATUS OLDSTATUS OUTCOME_POST_M  \\\n",
       "0             No    -         -      -         -              -   \n",
       "1             No    -         -      -         -              -   \n",
       "2             No    -         -      -         -              -   \n",
       "3             No    -         -      -         -              -   \n",
       "4             No    -         -      -         -              -   \n",
       "\n",
       "  HOST_OUTCOME_POST_M  \n",
       "0                   -  \n",
       "1                   -  \n",
       "2                   -  \n",
       "3                   -  \n",
       "4                   -  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "WithdrawalsJuly = pd.read_csv('Desktop/UCD/Assignment/Withdrawals Jul Week 4.csv')\n",
    "WithdrawalsJuly.head()\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4fd50b51-e8a9-4172-adae-cf89cf431957",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>49031629.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.277915e+09</td>\n",
       "      <td>23/06/2015</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostJacobA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>90157295.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.734859e+09</td>\n",
       "      <td>09/10/2017</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAlvaroL</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>61485978.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.790318e+09</td>\n",
       "      <td>11/01/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostRobertaC</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Closed Frozen Account</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>97403657.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.897316e+09</td>\n",
       "      <td>04/07/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostMarvinU</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>97792860.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.917632e+09</td>\n",
       "      <td>11/08/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostFabioS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Possible Hacking</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    USERINTID  VIP_STATUS       TRANSID     STARTED STATUS OLDSTATUS STATUS.1  \\\n",
       "0  49031629.0         0.0  1.277915e+09  23/06/2015      R         M        H   \n",
       "1  90157295.0         0.0  1.734859e+09  09/10/2017      R         M        H   \n",
       "2  61485978.0         0.0  1.790318e+09  11/01/2018      R         M        H   \n",
       "3  97403657.0         0.0  1.897316e+09  04/07/2018      R         M        H   \n",
       "4  97792860.0         0.0  1.917632e+09  11/08/2018      R         M        H   \n",
       "\n",
       "         USERID TRANSTYPE    RISK                 ATAS_RULE  \n",
       "0    HostJacobA         R  Medium       Blacklisted Country  \n",
       "1   HostAlvaroL         R  Medium  First Second Transaction  \n",
       "2  HostRobertaC         R  Medium     Closed Frozen Account  \n",
       "3   HostMarvinU         R  Medium  First Second Transaction  \n",
       "4    HostFabioS         R  Medium          Possible Hacking  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "ATAS_Alerts = pd.read_csv('Desktop/UCD/Assignment/ATAS Withdrawals Jun_Jul.csv')\n",
    "ATAS_Alerts.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "5d405508-924d-4be5-9890-92d82dcecab1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 37827 entries, 0 to 37826\n",
      "Data columns (total 11 columns):\n",
      " #   Column      Non-Null Count  Dtype  \n",
      "---  ------      --------------  -----  \n",
      " 0   USERINTID   37824 non-null  float64\n",
      " 1   VIP_STATUS  37824 non-null  float64\n",
      " 2   TRANSID     37824 non-null  float64\n",
      " 3   STARTED     37824 non-null  object \n",
      " 4   STATUS      37824 non-null  object \n",
      " 5   OLDSTATUS   37824 non-null  object \n",
      " 6   STATUS.1    37824 non-null  object \n",
      " 7   USERID      37824 non-null  object \n",
      " 8   TRANSTYPE   37824 non-null  object \n",
      " 9   RISK        37824 non-null  object \n",
      " 10  ATAS_RULE   37824 non-null  object \n",
      "dtypes: float64(3), object(8)\n",
      "memory usage: 3.2+ MB\n"
     ]
    }
   ],
   "source": [
    "ATAS_Alerts.info()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "6652cf5b-01c3-42dd-9c50-a2f8979711e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TRANSID</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1.277915e+09</th>\n",
       "      <td>49031629.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>23/06/2015</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostJacobA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.734859e+09</th>\n",
       "      <td>90157295.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>09/10/2017</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAlvaroL</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.790318e+09</th>\n",
       "      <td>61485978.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11/01/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostRobertaC</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Closed Frozen Account</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.897316e+09</th>\n",
       "      <td>97403657.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>04/07/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostMarvinU</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.917632e+09</th>\n",
       "      <td>97792860.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11/08/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostFabioS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Possible Hacking</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               USERINTID  VIP_STATUS     STARTED STATUS OLDSTATUS STATUS.1  \\\n",
       "TRANSID                                                                      \n",
       "1.277915e+09  49031629.0         0.0  23/06/2015      R         M        H   \n",
       "1.734859e+09  90157295.0         0.0  09/10/2017      R         M        H   \n",
       "1.790318e+09  61485978.0         0.0  11/01/2018      R         M        H   \n",
       "1.897316e+09  97403657.0         0.0  04/07/2018      R         M        H   \n",
       "1.917632e+09  97792860.0         0.0  11/08/2018      R         M        H   \n",
       "\n",
       "                    USERID TRANSTYPE    RISK                 ATAS_RULE  \n",
       "TRANSID                                                                 \n",
       "1.277915e+09    HostJacobA         R  Medium       Blacklisted Country  \n",
       "1.734859e+09   HostAlvaroL         R  Medium  First Second Transaction  \n",
       "1.790318e+09  HostRobertaC         R  Medium     Closed Frozen Account  \n",
       "1.897316e+09   HostMarvinU         R  Medium  First Second Transaction  \n",
       "1.917632e+09    HostFabioS         R  Medium          Possible Hacking  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ATAS_Alerts.set_index('TRANSID').head(5)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "73b83903-4250-4762-b8b8-feb1451a1d8b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "USERINTID             float64\n",
       "VIP_STATUS            float64\n",
       "TRANSID               float64\n",
       "STARTED        datetime64[ns]\n",
       "STATUS                 object\n",
       "OLDSTATUS              object\n",
       "STATUS.1               object\n",
       "USERID                 object\n",
       "TRANSTYPE              object\n",
       "RISK                   object\n",
       "ATAS_RULE              object\n",
       "Rule_Status            object\n",
       "dtype: object"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ATAS_Alerts.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "95a23650-e9d1-4f68-b341-d727135ad296",
   "metadata": {},
   "outputs": [],
   "source": [
    "ATAS_Alerts['STARTED'] = pd.to_datetime(ATAS_Alerts['STARTED'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cbe6224a-c6b9-4b14-8855-ee1503aa4e66",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(str, str)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type('STATUS'), type('ATAS_RULE')\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "42216b20-1ef2-4de8-a36a-447c1c136b23",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.info of          USERINTID  VIP_STATUS       TRANSID    STARTED STATUS OLDSTATUS  \\\n",
       "0       49031629.0         0.0  1.277915e+09 2015-06-23      R         M   \n",
       "1       90157295.0         0.0  1.734859e+09 2017-09-10      R         M   \n",
       "2       61485978.0         0.0  1.790318e+09 2018-11-01      R         M   \n",
       "3       97403657.0         0.0  1.897316e+09 2018-04-07      R         M   \n",
       "4       97792860.0         0.0  1.917632e+09 2018-11-08      R         M   \n",
       "...            ...         ...           ...        ...    ...       ...   \n",
       "37822  117818518.0         0.0  2.684903e+09 2021-07-31      A         M   \n",
       "37823   37148629.0         0.0  2.684903e+09 2021-07-31      R         M   \n",
       "37824          NaN         NaN           NaN        NaT    NaN       NaN   \n",
       "37825          NaN         NaN           NaN        NaT    NaN       NaN   \n",
       "37826          NaN         NaN           NaN        NaT    NaN       NaN   \n",
       "\n",
       "      STATUS.1         USERID TRANSTYPE    RISK                 ATAS_RULE  \\\n",
       "0            H     HostJacobA         R  Medium       Blacklisted Country   \n",
       "1            H    HostAlvaroL         R  Medium  First Second Transaction   \n",
       "2            H   HostRobertaC         R  Medium     Closed Frozen Account   \n",
       "3            H    HostMarvinU         R  Medium  First Second Transaction   \n",
       "4            H     HostFabioS         R  Medium          Possible Hacking   \n",
       "...        ...            ...       ...     ...                       ...   \n",
       "37822        V  HostPranathiA         R  Medium          Country Mismatch   \n",
       "37823        R  HostPranathiA         R  Medium         Turnover Of Funds   \n",
       "37824      NaN            NaN       NaN     NaN                       NaN   \n",
       "37825      NaN            NaN       NaN     NaN                       NaN   \n",
       "37826      NaN            NaN       NaN     NaN                       NaN   \n",
       "\n",
       "                     Rule_Status  \n",
       "0           Blacklisted CountryR  \n",
       "1      First Second TransactionR  \n",
       "2         Closed Frozen AccountR  \n",
       "3      First Second TransactionR  \n",
       "4              Possible HackingR  \n",
       "...                          ...  \n",
       "37822          Country MismatchA  \n",
       "37823         Turnover Of FundsR  \n",
       "37824                        NaN  \n",
       "37825                        NaN  \n",
       "37826                        NaN  \n",
       "\n",
       "[37827 rows x 12 columns]>"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ATAS_Alerts['Rule_Status'] = ATAS_Alerts['ATAS_RULE'] + ATAS_Alerts['STATUS']\n",
    "ATAS_Alerts.head(5)\n",
    "ATAS_Alerts.info\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "32d2ae91-ac32-436e-83e3-56f5e8cf94fe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                      ATAS_RULE  USERINTID  VIP_STATUS  TRANSID  STARTED  \\\n",
      "0                             -       7417        7417     7417     7417   \n",
      "1           Blacklisted Country       1111        1111     1111     1111   \n",
      "2               Blacklisted ISP         13          13       13       13   \n",
      "3               Bonus Trackcode         47          47       47       47   \n",
      "4         CSI Withdrawal Alerts        803         803      803      803   \n",
      "5             Cashout Cancelled        375         375      375      375   \n",
      "6         Closed Frozen Account          1           1        1        1   \n",
      "7              Country Mismatch       4637        4637     4637     4637   \n",
      "8        Cumulative Transfer-In        334         334      334      334   \n",
      "9               Fast Withdrawal         97          97       97       97   \n",
      "10     First Second Transaction       3586        3586     3586     3586   \n",
      "11                     GI Alert        615         615      615      615   \n",
      "12             High Risk Player       1859        1859     1859     1859   \n",
      "13                   Home Games        919         919      919      919   \n",
      "14                    KYC Score          1           1        1        1   \n",
      "15  Last Transaction Comparison         42          42       42       42   \n",
      "16                 Limits Tests       1007        1007     1007     1007   \n",
      "17                 LtFPP Filter          1           1        1        1   \n",
      "18       New Cashout Instrument       2820        2820     2820     2820   \n",
      "19                   New Player       2711        2711     2711     2711   \n",
      "20                  No Rule Met        330         330      330      330   \n",
      "21             Possible Hacking          1           1        1        1   \n",
      "22                 Safe Deposit          1           1        1        1   \n",
      "23           Source Of Winnings         39          39       39       39   \n",
      "24            Turnover Of Funds       8404        8404     8404     8404   \n",
      "25               Velocity Tests        386         386      386      386   \n",
      "26                     Win Rate        266         266      266      266   \n",
      "27     Withdrawal With Dormancy          1           1        1        1   \n",
      "\n",
      "    STATUS  OLDSTATUS  STATUS.1  USERID  TRANSTYPE  RISK  Rule_Status  \n",
      "0     7417       7417      7417    7417       7417  7417         7417  \n",
      "1     1111       1111      1111    1111       1111  1111         1111  \n",
      "2       13         13        13      13         13    13           13  \n",
      "3       47         47        47      47         47    47           47  \n",
      "4      803        803       803     803        803   803          803  \n",
      "5      375        375       375     375        375   375          375  \n",
      "6        1          1         1       1          1     1            1  \n",
      "7     4637       4637      4637    4637       4637  4637         4637  \n",
      "8      334        334       334     334        334   334          334  \n",
      "9       97         97        97      97         97    97           97  \n",
      "10    3586       3586      3586    3586       3586  3586         3586  \n",
      "11     615        615       615     615        615   615          615  \n",
      "12    1859       1859      1859    1859       1859  1859         1859  \n",
      "13     919        919       919     919        919   919          919  \n",
      "14       1          1         1       1          1     1            1  \n",
      "15      42         42        42      42         42    42           42  \n",
      "16    1007       1007      1007    1007       1007  1007         1007  \n",
      "17       1          1         1       1          1     1            1  \n",
      "18    2820       2820      2820    2820       2820  2820         2820  \n",
      "19    2711       2711      2711    2711       2711  2711         2711  \n",
      "20     330        330       330     330        330   330          330  \n",
      "21       1          1         1       1          1     1            1  \n",
      "22       1          1         1       1          1     1            1  \n",
      "23      39         39        39      39         39    39           39  \n",
      "24    8404       8404      8404    8404       8404  8404         8404  \n",
      "25     386        386       386     386        386   386          386  \n",
      "26     266        266       266     266        266   266          266  \n",
      "27       1          1         1       1          1     1            1  \n"
     ]
    }
   ],
   "source": [
    "Alerts_Per_Rule = ATAS_Alerts.groupby(['ATAS_RULE']).count().reset_index()\n",
    "print(Alerts_Per_Rule)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "0d439806-a0cf-4aa3-a62a-8ce4a8f3c037",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>Rule_Status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-</td>\n",
       "      <td>7417</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Blacklisted ISP</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bonus Trackcode</td>\n",
       "      <td>47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CSI Withdrawal Alerts</td>\n",
       "      <td>803</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cashout Cancelled</td>\n",
       "      <td>375</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Closed Frozen Account</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Country Mismatch</td>\n",
       "      <td>4637</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Cumulative Transfer-In</td>\n",
       "      <td>334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Fast Withdrawal</td>\n",
       "      <td>97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>First Second Transaction</td>\n",
       "      <td>3586</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>GI Alert</td>\n",
       "      <td>615</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>High Risk Player</td>\n",
       "      <td>1859</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Home Games</td>\n",
       "      <td>919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>KYC Score</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Last Transaction Comparison</td>\n",
       "      <td>42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Limits Tests</td>\n",
       "      <td>1007</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>LtFPP Filter</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>New Cashout Instrument</td>\n",
       "      <td>2820</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>New Player</td>\n",
       "      <td>2711</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>No Rule Met</td>\n",
       "      <td>330</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Possible Hacking</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Safe Deposit</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Source Of Winnings</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Turnover Of Funds</td>\n",
       "      <td>8404</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Velocity Tests</td>\n",
       "      <td>386</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Win Rate</td>\n",
       "      <td>266</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Withdrawal With Dormancy</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      ATAS_RULE  Rule_Status\n",
       "0                             -         7417\n",
       "1           Blacklisted Country         1111\n",
       "2               Blacklisted ISP           13\n",
       "3               Bonus Trackcode           47\n",
       "4         CSI Withdrawal Alerts          803\n",
       "5             Cashout Cancelled          375\n",
       "6         Closed Frozen Account            1\n",
       "7              Country Mismatch         4637\n",
       "8        Cumulative Transfer-In          334\n",
       "9               Fast Withdrawal           97\n",
       "10     First Second Transaction         3586\n",
       "11                     GI Alert          615\n",
       "12             High Risk Player         1859\n",
       "13                   Home Games          919\n",
       "14                    KYC Score            1\n",
       "15  Last Transaction Comparison           42\n",
       "16                 Limits Tests         1007\n",
       "17                 LtFPP Filter            1\n",
       "18       New Cashout Instrument         2820\n",
       "19                   New Player         2711\n",
       "20                  No Rule Met          330\n",
       "21             Possible Hacking            1\n",
       "22                 Safe Deposit            1\n",
       "23           Source Of Winnings           39\n",
       "24            Turnover Of Funds         8404\n",
       "25               Velocity Tests          386\n",
       "26                     Win Rate          266\n",
       "27     Withdrawal With Dormancy            1"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Count_Alerts = Alerts_Per_Rule[['ATAS_RULE', 'Rule_Status']]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "261b3736-bbee-448d-9221-bb2b35467e92",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 28 entries, 0 to 27\n",
      "Data columns (total 2 columns):\n",
      " #   Column         Non-Null Count  Dtype \n",
      "---  ------         --------------  ----- \n",
      " 0   ATAS_RULE      28 non-null     object\n",
      " 1   AlertsPerRule  28 non-null     object\n",
      "dtypes: object(2)\n",
      "memory usage: 576.0+ bytes\n"
     ]
    }
   ],
   "source": [
    "Count_Alerts.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "2af7e1c1-dae9-4eb5-9e03-733bdb98414d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>Rule_Status</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>49031629.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.277915e+09</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostJacobA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryR</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>98915645.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.993390e+09</td>\n",
       "      <td>2018-12-25</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostDiegoS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>75660408.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.213520e+09</td>\n",
       "      <td>2019-10-22</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostVaibhavK</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryR</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>58242663.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.247493e+09</td>\n",
       "      <td>2019-12-24</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostSaiMa</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>113282960.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.402107e+09</td>\n",
       "      <td>2020-10-07</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAleksandraP</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     USERINTID  VIP_STATUS       TRANSID    STARTED STATUS OLDSTATUS STATUS.1  \\\n",
       "0   49031629.0         0.0  1.277915e+09 2015-06-23      R         M        H   \n",
       "1   98915645.0         0.0  1.993390e+09 2018-12-25      A         M        H   \n",
       "2   75660408.0         0.0  2.213520e+09 2019-10-22      R         M        H   \n",
       "3   58242663.0         0.0  2.247493e+09 2019-12-24      A         M        H   \n",
       "4  113282960.0         0.0  2.402107e+09 2020-10-07      A         M        H   \n",
       "\n",
       "            USERID TRANSTYPE    RISK            ATAS_RULE  \\\n",
       "0       HostJacobA         R  Medium  Blacklisted Country   \n",
       "1       HostDiegoS         R  Medium  Blacklisted Country   \n",
       "2     HostVaibhavK         R  Medium  Blacklisted Country   \n",
       "3        HostSaiMa         R  Medium  Blacklisted Country   \n",
       "4  HostAleksandraP         R  Medium  Blacklisted Country   \n",
       "\n",
       "            Rule_Status AlertsPerRule  \n",
       "0  Blacklisted CountryR          1111  \n",
       "1  Blacklisted CountryA          1111  \n",
       "2  Blacklisted CountryR          1111  \n",
       "3  Blacklisted CountryA          1111  \n",
       "4  Blacklisted CountryA          1111  "
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "NewATAS_Alerts = ATAS_Alerts.merge(Count_Alerts)\n",
    "NewATAS_Alerts.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "0e7b05ad-7e7b-4e43-ba57-10dca081a3e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "def effective_rules(df):\n",
    "    if df in ['A']:\n",
    "        return 'Effective'\n",
    "    else:\n",
    "        return \"FalseAlarm\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "b839fff2-10e4-4c2f-ada9-fb0235b528fa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>Rule_Status</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "      <th>Effective_Rules</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>49031629.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.277915e+09</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostJacobA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryR</td>\n",
       "      <td>1111</td>\n",
       "      <td>FalseAlarm</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>98915645.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.993390e+09</td>\n",
       "      <td>2018-12-25</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostDiegoS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "      <td>Effective</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>75660408.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.213520e+09</td>\n",
       "      <td>2019-10-22</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostVaibhavK</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryR</td>\n",
       "      <td>1111</td>\n",
       "      <td>FalseAlarm</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>58242663.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.247493e+09</td>\n",
       "      <td>2019-12-24</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostSaiMa</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "      <td>Effective</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>113282960.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.402107e+09</td>\n",
       "      <td>2020-10-07</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAleksandraP</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "      <td>Effective</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     USERINTID  VIP_STATUS       TRANSID    STARTED STATUS OLDSTATUS STATUS.1  \\\n",
       "0   49031629.0         0.0  1.277915e+09 2015-06-23      R         M        H   \n",
       "1   98915645.0         0.0  1.993390e+09 2018-12-25      A         M        H   \n",
       "2   75660408.0         0.0  2.213520e+09 2019-10-22      R         M        H   \n",
       "3   58242663.0         0.0  2.247493e+09 2019-12-24      A         M        H   \n",
       "4  113282960.0         0.0  2.402107e+09 2020-10-07      A         M        H   \n",
       "\n",
       "            USERID TRANSTYPE    RISK            ATAS_RULE  \\\n",
       "0       HostJacobA         R  Medium  Blacklisted Country   \n",
       "1       HostDiegoS         R  Medium  Blacklisted Country   \n",
       "2     HostVaibhavK         R  Medium  Blacklisted Country   \n",
       "3        HostSaiMa         R  Medium  Blacklisted Country   \n",
       "4  HostAleksandraP         R  Medium  Blacklisted Country   \n",
       "\n",
       "            Rule_Status AlertsPerRule Effective_Rules  \n",
       "0  Blacklisted CountryR          1111      FalseAlarm  \n",
       "1  Blacklisted CountryA          1111       Effective  \n",
       "2  Blacklisted CountryR          1111      FalseAlarm  \n",
       "3  Blacklisted CountryA          1111       Effective  \n",
       "4  Blacklisted CountryA          1111       Effective  "
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "NewATAS_Alerts['Effective_Rules'] = NewATAS_Alerts['STATUS'].apply(effective_rules)\n",
    "NewATAS_Alerts.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "e1b76be2-0093-430e-a02c-127335863926",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>Rule_Status</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective_Rules</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>98915645.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.993390e+09</td>\n",
       "      <td>2018-12-25</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostDiegoS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>58242663.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.247493e+09</td>\n",
       "      <td>2019-12-24</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostSaiMa</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>113282960.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.402107e+09</td>\n",
       "      <td>2020-10-07</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAleksandraP</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>80229941.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.478876e+09</td>\n",
       "      <td>2020-03-11</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostRicardoMO</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>107209835.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.575271e+09</td>\n",
       "      <td>2021-02-27</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostFabioA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   USERINTID  VIP_STATUS       TRANSID    STARTED STATUS  \\\n",
       "Effective_Rules                                                            \n",
       "Effective         98915645.0         0.0  1.993390e+09 2018-12-25      A   \n",
       "Effective         58242663.0         0.0  2.247493e+09 2019-12-24      A   \n",
       "Effective        113282960.0         0.0  2.402107e+09 2020-10-07      A   \n",
       "Effective         80229941.0         0.0  2.478876e+09 2020-03-11      A   \n",
       "Effective        107209835.0         0.0  2.575271e+09 2021-02-27      A   \n",
       "\n",
       "                OLDSTATUS STATUS.1           USERID TRANSTYPE    RISK  \\\n",
       "Effective_Rules                                                         \n",
       "Effective               M        H       HostDiegoS         R  Medium   \n",
       "Effective               M        H        HostSaiMa         R  Medium   \n",
       "Effective               M        H  HostAleksandraP         R  Medium   \n",
       "Effective               M        H    HostRicardoMO         R  Medium   \n",
       "Effective               M        H       HostFabioA         R  Medium   \n",
       "\n",
       "                           ATAS_RULE           Rule_Status AlertsPerRule  \n",
       "Effective_Rules                                                           \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  "
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "All_Alerts = NewATAS_Alerts.set_index('Effective_Rules')\n",
    "Effective_Alerts.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "321924a7-299e-4e28-8482-045cfa07adeb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>Rule_Status</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective_Rules</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>98915645.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.993390e+09</td>\n",
       "      <td>2018-12-25</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostDiegoS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>58242663.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.247493e+09</td>\n",
       "      <td>2019-12-24</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostSaiMa</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>113282960.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.402107e+09</td>\n",
       "      <td>2020-10-07</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAleksandraP</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>80229941.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.478876e+09</td>\n",
       "      <td>2020-03-11</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostRicardoMO</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>107209835.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.575271e+09</td>\n",
       "      <td>2021-02-27</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostFabioA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>129982641.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.623653e+09</td>\n",
       "      <td>2021-04-29</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostHasanthP</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>74648402.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.631020e+09</td>\n",
       "      <td>2021-09-05</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostVincentP</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>103965030.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.638270e+09</td>\n",
       "      <td>2021-05-19</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostShusruthaV</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>33190005.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.640335e+09</td>\n",
       "      <td>2021-05-22</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostKrishnaG</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Effective</th>\n",
       "      <td>80202717.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.642075e+09</td>\n",
       "      <td>2021-05-25</td>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostZhenyaS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>Blacklisted CountryA</td>\n",
       "      <td>1111</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   USERINTID  VIP_STATUS       TRANSID    STARTED STATUS  \\\n",
       "Effective_Rules                                                            \n",
       "Effective         98915645.0         0.0  1.993390e+09 2018-12-25      A   \n",
       "Effective         58242663.0         0.0  2.247493e+09 2019-12-24      A   \n",
       "Effective        113282960.0         0.0  2.402107e+09 2020-10-07      A   \n",
       "Effective         80229941.0         0.0  2.478876e+09 2020-03-11      A   \n",
       "Effective        107209835.0         0.0  2.575271e+09 2021-02-27      A   \n",
       "Effective        129982641.0         0.0  2.623653e+09 2021-04-29      A   \n",
       "Effective         74648402.0         0.0  2.631020e+09 2021-09-05      A   \n",
       "Effective        103965030.0         0.0  2.638270e+09 2021-05-19      A   \n",
       "Effective         33190005.0         0.0  2.640335e+09 2021-05-22      A   \n",
       "Effective         80202717.0         0.0  2.642075e+09 2021-05-25      A   \n",
       "\n",
       "                OLDSTATUS STATUS.1           USERID TRANSTYPE    RISK  \\\n",
       "Effective_Rules                                                         \n",
       "Effective               M        H       HostDiegoS         R  Medium   \n",
       "Effective               M        H        HostSaiMa         R  Medium   \n",
       "Effective               M        H  HostAleksandraP         R  Medium   \n",
       "Effective               M        H    HostRicardoMO         R  Medium   \n",
       "Effective               M        H       HostFabioA         R  Medium   \n",
       "Effective               M        H     HostHasanthP         R  Medium   \n",
       "Effective               M        H     HostVincentP         R  Medium   \n",
       "Effective               M        H   HostShusruthaV         R  Medium   \n",
       "Effective               M        H     HostKrishnaG         R  Medium   \n",
       "Effective               M        H      HostZhenyaS         R  Medium   \n",
       "\n",
       "                           ATAS_RULE           Rule_Status AlertsPerRule  \n",
       "Effective_Rules                                                           \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  \n",
       "Effective        Blacklisted Country  Blacklisted CountryA          1111  "
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Effective_Alerts = All_Alerts.drop('FalseAlarm')\n",
    "Effective_Alerts.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "719e24a2-c35e-4564-815e-aa907404634e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>Rule_Status</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "      <td>5598</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "      <td>967</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Blacklisted ISP</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bonus Trackcode</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CSI Withdrawal Alerts</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "      <td>519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cashout Cancelled</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "      <td>286</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Country Mismatch</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "      <td>3953</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Cumulative Transfer-In</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "      <td>64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Fast Withdrawal</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>First Second Transaction</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "      <td>3028</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  ATAS_RULE  USERINTID  VIP_STATUS  TRANSID  STARTED  STATUS  \\\n",
       "0                         -       5598        5598     5598     5598    5598   \n",
       "1       Blacklisted Country        967         967      967      967     967   \n",
       "2           Blacklisted ISP         12          12       12       12      12   \n",
       "3           Bonus Trackcode         36          36       36       36      36   \n",
       "4     CSI Withdrawal Alerts        519         519      519      519     519   \n",
       "5         Cashout Cancelled        286         286      286      286     286   \n",
       "6          Country Mismatch       3953        3953     3953     3953    3953   \n",
       "7    Cumulative Transfer-In         64          64       64       64      64   \n",
       "8           Fast Withdrawal         63          63       63       63      63   \n",
       "9  First Second Transaction       3028        3028     3028     3028    3028   \n",
       "\n",
       "   OLDSTATUS  STATUS.1  USERID  TRANSTYPE  RISK  Rule_Status  AlertsPerRule  \n",
       "0       5598      5598    5598       5598  5598         5598           5598  \n",
       "1        967       967     967        967   967          967            967  \n",
       "2         12        12      12         12    12           12             12  \n",
       "3         36        36      36         36    36           36             36  \n",
       "4        519       519     519        519   519          519            519  \n",
       "5        286       286     286        286   286          286            286  \n",
       "6       3953      3953    3953       3953  3953         3953           3953  \n",
       "7         64        64      64         64    64           64             64  \n",
       "8         63        63      63         63    63           63             63  \n",
       "9       3028      3028    3028       3028  3028         3028           3028  "
      ]
     },
     "execution_count": 81,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CountEffectiveAlerts = Effective_Alerts.groupby('ATAS_RULE').count().reset_index()\n",
    "CountEffectiveAlerts.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "id": "5b9811ec-8a1b-4b3e-927a-1bc463d28f38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>STATUS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-</td>\n",
       "      <td>5598</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>967</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Blacklisted ISP</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bonus Trackcode</td>\n",
       "      <td>36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CSI Withdrawal Alerts</td>\n",
       "      <td>519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cashout Cancelled</td>\n",
       "      <td>286</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Country Mismatch</td>\n",
       "      <td>3953</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Cumulative Transfer-In</td>\n",
       "      <td>64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Fast Withdrawal</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>First Second Transaction</td>\n",
       "      <td>3028</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>GI Alert</td>\n",
       "      <td>470</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>High Risk Player</td>\n",
       "      <td>1554</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Home Games</td>\n",
       "      <td>682</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Last Transaction Comparison</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Limits Tests</td>\n",
       "      <td>857</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>LtFPP Filter</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>New Cashout Instrument</td>\n",
       "      <td>2304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>New Player</td>\n",
       "      <td>2099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>No Rule Met</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Source Of Winnings</td>\n",
       "      <td>35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Turnover Of Funds</td>\n",
       "      <td>4064</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Velocity Tests</td>\n",
       "      <td>362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Win Rate</td>\n",
       "      <td>227</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Withdrawal With Dormancy</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      ATAS_RULE  STATUS\n",
       "0                             -    5598\n",
       "1           Blacklisted Country     967\n",
       "2               Blacklisted ISP      12\n",
       "3               Bonus Trackcode      36\n",
       "4         CSI Withdrawal Alerts     519\n",
       "5             Cashout Cancelled     286\n",
       "6              Country Mismatch    3953\n",
       "7        Cumulative Transfer-In      64\n",
       "8               Fast Withdrawal      63\n",
       "9      First Second Transaction    3028\n",
       "10                     GI Alert     470\n",
       "11             High Risk Player    1554\n",
       "12                   Home Games     682\n",
       "13  Last Transaction Comparison      30\n",
       "14                 Limits Tests     857\n",
       "15                 LtFPP Filter       1\n",
       "16       New Cashout Instrument    2304\n",
       "17                   New Player    2099\n",
       "18                  No Rule Met      20\n",
       "19           Source Of Winnings      35\n",
       "20            Turnover Of Funds    4064\n",
       "21               Velocity Tests     362\n",
       "22                     Win Rate     227\n",
       "23     Withdrawal With Dormancy       1"
      ]
     },
     "execution_count": 121,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CountEffectiveAlerts = CountEffectiveAlerts[['ATAS_RULE', 'STATUS']]\n",
    "CountEffectiveAlerts.head(24)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "id": "c34d91b2-b0d9-4b56-828e-cf301240a643",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "      <th>STATUS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-</td>\n",
       "      <td>7417</td>\n",
       "      <td>5598.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>1111</td>\n",
       "      <td>967.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Blacklisted ISP</td>\n",
       "      <td>13</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bonus Trackcode</td>\n",
       "      <td>47</td>\n",
       "      <td>36.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CSI Withdrawal Alerts</td>\n",
       "      <td>803</td>\n",
       "      <td>519.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cashout Cancelled</td>\n",
       "      <td>375</td>\n",
       "      <td>286.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Closed Frozen Account</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Country Mismatch</td>\n",
       "      <td>4637</td>\n",
       "      <td>3953.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Cumulative Transfer-In</td>\n",
       "      <td>334</td>\n",
       "      <td>64.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Fast Withdrawal</td>\n",
       "      <td>97</td>\n",
       "      <td>63.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>First Second Transaction</td>\n",
       "      <td>3586</td>\n",
       "      <td>3028.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>GI Alert</td>\n",
       "      <td>615</td>\n",
       "      <td>470.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>High Risk Player</td>\n",
       "      <td>1859</td>\n",
       "      <td>1554.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Home Games</td>\n",
       "      <td>919</td>\n",
       "      <td>682.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>KYC Score</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Last Transaction Comparison</td>\n",
       "      <td>42</td>\n",
       "      <td>30.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Limits Tests</td>\n",
       "      <td>1007</td>\n",
       "      <td>857.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>LtFPP Filter</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>New Cashout Instrument</td>\n",
       "      <td>2820</td>\n",
       "      <td>2304.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>New Player</td>\n",
       "      <td>2711</td>\n",
       "      <td>2099.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>No Rule Met</td>\n",
       "      <td>330</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Possible Hacking</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Safe Deposit</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Source Of Winnings</td>\n",
       "      <td>39</td>\n",
       "      <td>35.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      ATAS_RULE AlertsPerRule  STATUS\n",
       "0                             -          7417  5598.0\n",
       "1           Blacklisted Country          1111   967.0\n",
       "2               Blacklisted ISP            13    12.0\n",
       "3               Bonus Trackcode            47    36.0\n",
       "4         CSI Withdrawal Alerts           803   519.0\n",
       "5             Cashout Cancelled           375   286.0\n",
       "6         Closed Frozen Account             1     NaN\n",
       "7              Country Mismatch          4637  3953.0\n",
       "8        Cumulative Transfer-In           334    64.0\n",
       "9               Fast Withdrawal            97    63.0\n",
       "10     First Second Transaction          3586  3028.0\n",
       "11                     GI Alert           615   470.0\n",
       "12             High Risk Player          1859  1554.0\n",
       "13                   Home Games           919   682.0\n",
       "14                    KYC Score             1     NaN\n",
       "15  Last Transaction Comparison            42    30.0\n",
       "16                 Limits Tests          1007   857.0\n",
       "17                 LtFPP Filter             1     1.0\n",
       "18       New Cashout Instrument          2820  2304.0\n",
       "19                   New Player          2711  2099.0\n",
       "20                  No Rule Met           330    20.0\n",
       "21             Possible Hacking             1     NaN\n",
       "22                 Safe Deposit             1     NaN\n",
       "23           Source Of Winnings            39    35.0"
      ]
     },
     "execution_count": 132,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Effective_Alerts = Count_Alerts.merge(CountEffectiveAlerts, how='outer')\n",
    "Effective_Alerts.head(24)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "5b5f4fd1-6333-4b86-b34b-dbe5b4af6b2c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>PercentageEffective</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-</td>\n",
       "      <td>7417.0</td>\n",
       "      <td>5598.0</td>\n",
       "      <td>75.475260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>1111.0</td>\n",
       "      <td>967.0</td>\n",
       "      <td>87.038704</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Blacklisted ISP</td>\n",
       "      <td>13.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>92.307692</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bonus Trackcode</td>\n",
       "      <td>47.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>76.595745</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CSI Withdrawal Alerts</td>\n",
       "      <td>803.0</td>\n",
       "      <td>519.0</td>\n",
       "      <td>64.632628</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cashout Cancelled</td>\n",
       "      <td>375.0</td>\n",
       "      <td>286.0</td>\n",
       "      <td>76.266667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Closed Frozen Account</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Country Mismatch</td>\n",
       "      <td>4637.0</td>\n",
       "      <td>3953.0</td>\n",
       "      <td>85.249083</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Cumulative Transfer-In</td>\n",
       "      <td>334.0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>19.161677</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Fast Withdrawal</td>\n",
       "      <td>97.0</td>\n",
       "      <td>63.0</td>\n",
       "      <td>64.948454</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>First Second Transaction</td>\n",
       "      <td>3586.0</td>\n",
       "      <td>3028.0</td>\n",
       "      <td>84.439487</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>GI Alert</td>\n",
       "      <td>615.0</td>\n",
       "      <td>470.0</td>\n",
       "      <td>76.422764</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>High Risk Player</td>\n",
       "      <td>1859.0</td>\n",
       "      <td>1554.0</td>\n",
       "      <td>83.593330</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Home Games</td>\n",
       "      <td>919.0</td>\n",
       "      <td>682.0</td>\n",
       "      <td>74.211099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>KYC Score</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Last Transaction Comparison</td>\n",
       "      <td>42.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>71.428571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Limits Tests</td>\n",
       "      <td>1007.0</td>\n",
       "      <td>857.0</td>\n",
       "      <td>85.104270</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>LtFPP Filter</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>100.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>New Cashout Instrument</td>\n",
       "      <td>2820.0</td>\n",
       "      <td>2304.0</td>\n",
       "      <td>81.702128</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>New Player</td>\n",
       "      <td>2711.0</td>\n",
       "      <td>2099.0</td>\n",
       "      <td>77.425304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>No Rule Met</td>\n",
       "      <td>330.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>6.060606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Possible Hacking</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Safe Deposit</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Source Of Winnings</td>\n",
       "      <td>39.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>89.743590</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Turnover Of Funds</td>\n",
       "      <td>8404.0</td>\n",
       "      <td>4064.0</td>\n",
       "      <td>48.357925</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Velocity Tests</td>\n",
       "      <td>386.0</td>\n",
       "      <td>362.0</td>\n",
       "      <td>93.782383</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Win Rate</td>\n",
       "      <td>266.0</td>\n",
       "      <td>227.0</td>\n",
       "      <td>85.338346</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Withdrawal With Dormancy</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>100.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      ATAS_RULE  AlertsPerRule  STATUS  PercentageEffective\n",
       "0                             -         7417.0  5598.0            75.475260\n",
       "1           Blacklisted Country         1111.0   967.0            87.038704\n",
       "2               Blacklisted ISP           13.0    12.0            92.307692\n",
       "3               Bonus Trackcode           47.0    36.0            76.595745\n",
       "4         CSI Withdrawal Alerts          803.0   519.0            64.632628\n",
       "5             Cashout Cancelled          375.0   286.0            76.266667\n",
       "6         Closed Frozen Account            1.0     0.0             0.000000\n",
       "7              Country Mismatch         4637.0  3953.0            85.249083\n",
       "8        Cumulative Transfer-In          334.0    64.0            19.161677\n",
       "9               Fast Withdrawal           97.0    63.0            64.948454\n",
       "10     First Second Transaction         3586.0  3028.0            84.439487\n",
       "11                     GI Alert          615.0   470.0            76.422764\n",
       "12             High Risk Player         1859.0  1554.0            83.593330\n",
       "13                   Home Games          919.0   682.0            74.211099\n",
       "14                    KYC Score            1.0     0.0             0.000000\n",
       "15  Last Transaction Comparison           42.0    30.0            71.428571\n",
       "16                 Limits Tests         1007.0   857.0            85.104270\n",
       "17                 LtFPP Filter            1.0     1.0           100.000000\n",
       "18       New Cashout Instrument         2820.0  2304.0            81.702128\n",
       "19                   New Player         2711.0  2099.0            77.425304\n",
       "20                  No Rule Met          330.0    20.0             6.060606\n",
       "21             Possible Hacking            1.0     0.0             0.000000\n",
       "22                 Safe Deposit            1.0     0.0             0.000000\n",
       "23           Source Of Winnings           39.0    35.0            89.743590\n",
       "24            Turnover Of Funds         8404.0  4064.0            48.357925\n",
       "25               Velocity Tests          386.0   362.0            93.782383\n",
       "26                     Win Rate          266.0   227.0            85.338346\n",
       "27     Withdrawal With Dormancy            1.0     1.0           100.000000"
      ]
     },
     "execution_count": 149,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Effective_Alerts[['AlertsPerRule', 'STATUS']] = Effective_Alerts[['AlertsPerRule', 'STATUS']].fillna(0)\n",
    "Effective_Alerts.head(30)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "554f9ad5-1a57-4a99-83f2-6021ad220a3f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 28 entries, 0 to 27\n",
      "Data columns (total 3 columns):\n",
      " #   Column         Non-Null Count  Dtype  \n",
      "---  ------         --------------  -----  \n",
      " 0   ATAS_RULE      28 non-null     object \n",
      " 1   AlertsPerRule  28 non-null     object \n",
      " 2   STATUS         28 non-null     float64\n",
      "dtypes: float64(1), object(2)\n",
      "memory usage: 896.0+ bytes\n"
     ]
    }
   ],
   "source": [
    "Effective_Alerts.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "5f580f58-b29f-4daa-9c01-5da314cbefbe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ATAS_RULE         object\n",
       "AlertsPerRule    float64\n",
       "STATUS           float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 136,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Effective_Alerts[\"AlertsPerRule\"] = Effective_Alerts[\"AlertsPerRule\"].astype('float64')\n",
    "Effective_Alerts.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "id": "dcb9ba9f-5003-4fc5-bf4f-d130bae3a232",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>AlertsPerRule</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>PercentageEffective</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-</td>\n",
       "      <td>7417.0</td>\n",
       "      <td>5598.0</td>\n",
       "      <td>75.475260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Blacklisted Country</td>\n",
       "      <td>1111.0</td>\n",
       "      <td>967.0</td>\n",
       "      <td>87.038704</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Blacklisted ISP</td>\n",
       "      <td>13.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>92.307692</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bonus Trackcode</td>\n",
       "      <td>47.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>76.595745</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CSI Withdrawal Alerts</td>\n",
       "      <td>803.0</td>\n",
       "      <td>519.0</td>\n",
       "      <td>64.632628</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               ATAS_RULE  AlertsPerRule  STATUS  PercentageEffective\n",
       "0                      -         7417.0  5598.0            75.475260\n",
       "1    Blacklisted Country         1111.0   967.0            87.038704\n",
       "2        Blacklisted ISP           13.0    12.0            92.307692\n",
       "3        Bonus Trackcode           47.0    36.0            76.595745\n",
       "4  CSI Withdrawal Alerts          803.0   519.0            64.632628"
      ]
     },
     "execution_count": 139,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Effective_Alerts['PercentageEffective'] = (Effective_Alerts['STATUS'] / Effective_Alerts['AlertsPerRule'])*100\n",
    "Effective_Alerts.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "id": "af4f95b7-f8b9-4a25-ada7-85b303cb466f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AlertsPerRule</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>PercentageEffective</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>-</th>\n",
       "      <td>7417.0</td>\n",
       "      <td>5598.0</td>\n",
       "      <td>75.475260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Blacklisted Country</th>\n",
       "      <td>1111.0</td>\n",
       "      <td>967.0</td>\n",
       "      <td>87.038704</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Blacklisted ISP</th>\n",
       "      <td>13.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>92.307692</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bonus Trackcode</th>\n",
       "      <td>47.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>76.595745</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CSI Withdrawal Alerts</th>\n",
       "      <td>803.0</td>\n",
       "      <td>519.0</td>\n",
       "      <td>64.632628</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cashout Cancelled</th>\n",
       "      <td>375.0</td>\n",
       "      <td>286.0</td>\n",
       "      <td>76.266667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Closed Frozen Account</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Country Mismatch</th>\n",
       "      <td>4637.0</td>\n",
       "      <td>3953.0</td>\n",
       "      <td>85.249083</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cumulative Transfer-In</th>\n",
       "      <td>334.0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>19.161677</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fast Withdrawal</th>\n",
       "      <td>97.0</td>\n",
       "      <td>63.0</td>\n",
       "      <td>64.948454</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Second Transaction</th>\n",
       "      <td>3586.0</td>\n",
       "      <td>3028.0</td>\n",
       "      <td>84.439487</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GI Alert</th>\n",
       "      <td>615.0</td>\n",
       "      <td>470.0</td>\n",
       "      <td>76.422764</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>High Risk Player</th>\n",
       "      <td>1859.0</td>\n",
       "      <td>1554.0</td>\n",
       "      <td>83.593330</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Home Games</th>\n",
       "      <td>919.0</td>\n",
       "      <td>682.0</td>\n",
       "      <td>74.211099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>KYC Score</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Last Transaction Comparison</th>\n",
       "      <td>42.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>71.428571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Limits Tests</th>\n",
       "      <td>1007.0</td>\n",
       "      <td>857.0</td>\n",
       "      <td>85.104270</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LtFPP Filter</th>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>100.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>New Cashout Instrument</th>\n",
       "      <td>2820.0</td>\n",
       "      <td>2304.0</td>\n",
       "      <td>81.702128</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>New Player</th>\n",
       "      <td>2711.0</td>\n",
       "      <td>2099.0</td>\n",
       "      <td>77.425304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>No Rule Met</th>\n",
       "      <td>330.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>6.060606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Possible Hacking</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Safe Deposit</th>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Source Of Winnings</th>\n",
       "      <td>39.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>89.743590</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Turnover Of Funds</th>\n",
       "      <td>8404.0</td>\n",
       "      <td>4064.0</td>\n",
       "      <td>48.357925</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Velocity Tests</th>\n",
       "      <td>386.0</td>\n",
       "      <td>362.0</td>\n",
       "      <td>93.782383</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Win Rate</th>\n",
       "      <td>266.0</td>\n",
       "      <td>227.0</td>\n",
       "      <td>85.338346</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Withdrawal With Dormancy</th>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>100.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                             AlertsPerRule  STATUS  PercentageEffective\n",
       "ATAS_RULE                                                              \n",
       "-                                   7417.0  5598.0            75.475260\n",
       "Blacklisted Country                 1111.0   967.0            87.038704\n",
       "Blacklisted ISP                       13.0    12.0            92.307692\n",
       "Bonus Trackcode                       47.0    36.0            76.595745\n",
       "CSI Withdrawal Alerts                803.0   519.0            64.632628\n",
       "Cashout Cancelled                    375.0   286.0            76.266667\n",
       "Closed Frozen Account                  1.0     0.0             0.000000\n",
       "Country Mismatch                    4637.0  3953.0            85.249083\n",
       "Cumulative Transfer-In               334.0    64.0            19.161677\n",
       "Fast Withdrawal                       97.0    63.0            64.948454\n",
       "First Second Transaction            3586.0  3028.0            84.439487\n",
       "GI Alert                             615.0   470.0            76.422764\n",
       "High Risk Player                    1859.0  1554.0            83.593330\n",
       "Home Games                           919.0   682.0            74.211099\n",
       "KYC Score                              1.0     0.0             0.000000\n",
       "Last Transaction Comparison           42.0    30.0            71.428571\n",
       "Limits Tests                        1007.0   857.0            85.104270\n",
       "LtFPP Filter                           1.0     1.0           100.000000\n",
       "New Cashout Instrument              2820.0  2304.0            81.702128\n",
       "New Player                          2711.0  2099.0            77.425304\n",
       "No Rule Met                          330.0    20.0             6.060606\n",
       "Possible Hacking                       1.0     0.0             0.000000\n",
       "Safe Deposit                           1.0     0.0             0.000000\n",
       "Source Of Winnings                    39.0    35.0            89.743590\n",
       "Turnover Of Funds                   8404.0  4064.0            48.357925\n",
       "Velocity Tests                       386.0   362.0            93.782383\n",
       "Win Rate                             266.0   227.0            85.338346\n",
       "Withdrawal With Dormancy               1.0     1.0           100.000000"
      ]
     },
     "execution_count": 146,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Effective_Alerts.set_index('ATAS_RULE')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8b0dd9f-7ed1-4454-9857-3f682cd95521",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a15742ef-f65d-4146-a92e-d32f9645c712",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
