{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "76e08493-bf0b-484a-9197-1a188831fd53",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>COMPLETION_DATE</th>\n",
       "      <th>USD_AMOUNT</th>\n",
       "      <th>ACCOUNT_CURRENCY</th>\n",
       "      <th>PAYSYSTEM</th>\n",
       "      <th>GATEWAY</th>\n",
       "      <th>ROLLBACK</th>\n",
       "      <th>OVERCREDIT</th>\n",
       "      <th>FINAL_STATUS</th>\n",
       "      <th>ATAS_SCREENING</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>OUTCOME_POST_M</th>\n",
       "      <th>HOST_OUTCOME_POST_M</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>63786440</td>\n",
       "      <td>0</td>\n",
       "      <td>2680739487</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>11.26</td>\n",
       "      <td>EUR</td>\n",
       "      <td>TAX</td>\n",
       "      <td>ADMIN</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>113590940</td>\n",
       "      <td>0</td>\n",
       "      <td>2680726130</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>0</td>\n",
       "      <td>CAD</td>\n",
       "      <td>DIRBANK</td>\n",
       "      <td>GCash</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>130060541</td>\n",
       "      <td>0</td>\n",
       "      <td>2680728142</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>137.43</td>\n",
       "      <td>GBP</td>\n",
       "      <td>MASTERCARD</td>\n",
       "      <td>WORLDPAY_WPG</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>59425843</td>\n",
       "      <td>0</td>\n",
       "      <td>2680719397</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>9.88</td>\n",
       "      <td>EUR</td>\n",
       "      <td>TAX</td>\n",
       "      <td>ADMIN</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>95610708</td>\n",
       "      <td>0</td>\n",
       "      <td>2680727257</td>\n",
       "      <td>25/07/2021</td>\n",
       "      <td>411.99</td>\n",
       "      <td>EUR</td>\n",
       "      <td>PAYPAL</td>\n",
       "      <td>PAYPALDIRECT</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>A</td>\n",
       "      <td>No</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   USERINTID  VIP_STATUS     TRANSID COMPLETION_DATE  USD_AMOUNT   \\\n",
       "0   63786440           0  2680739487      25/07/2021        11.26   \n",
       "1  113590940           0  2680726130      25/07/2021            0   \n",
       "2  130060541           0  2680728142      25/07/2021       137.43   \n",
       "3   59425843           0  2680719397      25/07/2021         9.88   \n",
       "4   95610708           0  2680727257      25/07/2021       411.99   \n",
       "\n",
       "  ACCOUNT_CURRENCY   PAYSYSTEM       GATEWAY ROLLBACK OVERCREDIT FINAL_STATUS  \\\n",
       "0              EUR         TAX         ADMIN       No        Yes            A   \n",
       "1              CAD     DIRBANK         GCash       No        Yes            A   \n",
       "2              GBP  MASTERCARD  WORLDPAY_WPG      Yes         No            A   \n",
       "3              EUR         TAX         ADMIN       No        Yes            A   \n",
       "4              EUR      PAYPAL  PAYPALDIRECT       No        Yes            A   \n",
       "\n",
       "  ATAS_SCREENING RISK ATAS_RULE STATUS OLDSTATUS OUTCOME_POST_M  \\\n",
       "0             No    -         -      -         -              -   \n",
       "1             No    -         -      -         -              -   \n",
       "2             No    -         -      -         -              -   \n",
       "3             No    -         -      -         -              -   \n",
       "4             No    -         -      -         -              -   \n",
       "\n",
       "  HOST_OUTCOME_POST_M  \n",
       "0                   -  \n",
       "1                   -  \n",
       "2                   -  \n",
       "3                   -  \n",
       "4                   -  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "WithdrawalsJuly = pd.read_csv('Desktop/UCD/Assignment/Withdrawals Jul Week 4.csv')\n",
    "WithdrawalsJuly.head()\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4fd50b51-e8a9-4172-adae-cf89cf431957",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>TRANSID</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>49031629.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.277915e+09</td>\n",
       "      <td>23/06/2015</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostJacobA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>90157295.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.734859e+09</td>\n",
       "      <td>09/10/2017</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAlvaroL</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>61485978.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.790318e+09</td>\n",
       "      <td>11/01/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostRobertaC</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Closed Frozen Account</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>97403657.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.897316e+09</td>\n",
       "      <td>04/07/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostMarvinU</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>97792860.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.917632e+09</td>\n",
       "      <td>11/08/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostFabioS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Possible Hacking</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    USERINTID  VIP_STATUS       TRANSID     STARTED STATUS OLDSTATUS STATUS.1  \\\n",
       "0  49031629.0         0.0  1.277915e+09  23/06/2015      R         M        H   \n",
       "1  90157295.0         0.0  1.734859e+09  09/10/2017      R         M        H   \n",
       "2  61485978.0         0.0  1.790318e+09  11/01/2018      R         M        H   \n",
       "3  97403657.0         0.0  1.897316e+09  04/07/2018      R         M        H   \n",
       "4  97792860.0         0.0  1.917632e+09  11/08/2018      R         M        H   \n",
       "\n",
       "         USERID TRANSTYPE    RISK                 ATAS_RULE  \n",
       "0    HostJacobA         R  Medium       Blacklisted Country  \n",
       "1   HostAlvaroL         R  Medium  First Second Transaction  \n",
       "2  HostRobertaC         R  Medium     Closed Frozen Account  \n",
       "3   HostMarvinU         R  Medium  First Second Transaction  \n",
       "4    HostFabioS         R  Medium          Possible Hacking  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "ATAS_Alerts = pd.read_csv('Desktop/UCD/Assignment/ATAS Withdrawals Jun_Jul.csv')\n",
    "ATAS_Alerts.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5d405508-924d-4be5-9890-92d82dcecab1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 37827 entries, 0 to 37826\n",
      "Data columns (total 11 columns):\n",
      " #   Column      Non-Null Count  Dtype  \n",
      "---  ------      --------------  -----  \n",
      " 0   USERINTID   37824 non-null  float64\n",
      " 1   VIP_STATUS  37824 non-null  float64\n",
      " 2   TRANSID     37824 non-null  float64\n",
      " 3   STARTED     37824 non-null  object \n",
      " 4   STATUS      37824 non-null  object \n",
      " 5   OLDSTATUS   37824 non-null  object \n",
      " 6   STATUS.1    37824 non-null  object \n",
      " 7   USERID      37824 non-null  object \n",
      " 8   TRANSTYPE   37824 non-null  object \n",
      " 9   RISK        37824 non-null  object \n",
      " 10  ATAS_RULE   37824 non-null  object \n",
      "dtypes: float64(3), object(8)\n",
      "memory usage: 3.2+ MB\n"
     ]
    }
   ],
   "source": [
    "ATAS_Alerts.info()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6652cf5b-01c3-42dd-9c50-a2f8979711e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>USERINTID</th>\n",
       "      <th>VIP_STATUS</th>\n",
       "      <th>STARTED</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>OLDSTATUS</th>\n",
       "      <th>STATUS.1</th>\n",
       "      <th>USERID</th>\n",
       "      <th>TRANSTYPE</th>\n",
       "      <th>RISK</th>\n",
       "      <th>ATAS_RULE</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TRANSID</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1.277915e+09</th>\n",
       "      <td>49031629.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>23/06/2015</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostJacobA</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Blacklisted Country</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.734859e+09</th>\n",
       "      <td>90157295.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>09/10/2017</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostAlvaroL</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.790318e+09</th>\n",
       "      <td>61485978.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11/01/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostRobertaC</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Closed Frozen Account</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.897316e+09</th>\n",
       "      <td>97403657.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>04/07/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostMarvinU</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>First Second Transaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.917632e+09</th>\n",
       "      <td>97792860.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11/08/2018</td>\n",
       "      <td>R</td>\n",
       "      <td>M</td>\n",
       "      <td>H</td>\n",
       "      <td>HostFabioS</td>\n",
       "      <td>R</td>\n",
       "      <td>Medium</td>\n",
       "      <td>Possible Hacking</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               USERINTID  VIP_STATUS     STARTED STATUS OLDSTATUS STATUS.1  \\\n",
       "TRANSID                                                                      \n",
       "1.277915e+09  49031629.0         0.0  23/06/2015      R         M        H   \n",
       "1.734859e+09  90157295.0         0.0  09/10/2017      R         M        H   \n",
       "1.790318e+09  61485978.0         0.0  11/01/2018      R         M        H   \n",
       "1.897316e+09  97403657.0         0.0  04/07/2018      R         M        H   \n",
       "1.917632e+09  97792860.0         0.0  11/08/2018      R         M        H   \n",
       "\n",
       "                    USERID TRANSTYPE    RISK                 ATAS_RULE  \n",
       "TRANSID                                                                 \n",
       "1.277915e+09    HostJacobA         R  Medium       Blacklisted Country  \n",
       "1.734859e+09   HostAlvaroL         R  Medium  First Second Transaction  \n",
       "1.790318e+09  HostRobertaC         R  Medium     Closed Frozen Account  \n",
       "1.897316e+09   HostMarvinU         R  Medium  First Second Transaction  \n",
       "1.917632e+09    HostFabioS         R  Medium          Possible Hacking  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ATAS_Alerts.set_index('TRANSID').head(5)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "73b83903-4250-4762-b8b8-feb1451a1d8b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "USERINTID     float64\n",
       "VIP_STATUS    float64\n",
       "TRANSID       float64\n",
       "STARTED        object\n",
       "STATUS         object\n",
       "OLDSTATUS      object\n",
       "STATUS.1       object\n",
       "USERID         object\n",
       "TRANSTYPE      object\n",
       "RISK           object\n",
       "ATAS_RULE      object\n",
       "dtype: object"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ATAS_Alerts.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "95a23650-e9d1-4f68-b341-d727135ad296",
   "metadata": {},
   "outputs": [],
   "source": [
    "ATAS_Alerts['STARTED'] = pd.to_datetime(ATAS_Alerts['STARTED'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "cbe6224a-c6b9-4b14-8855-ee1503aa4e66",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(str, str)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type('STATUS'), type('ATAS_RULE')\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "42216b20-1ef2-4de8-a36a-447c1c136b23",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method DataFrame.info of          USERINTID  VIP_STATUS       TRANSID    STARTED STATUS OLDSTATUS  \\\n",
       "0       49031629.0         0.0  1.277915e+09 2015-06-23      R         M   \n",
       "1       90157295.0         0.0  1.734859e+09 2017-09-10      R         M   \n",
       "2       61485978.0         0.0  1.790318e+09 2018-11-01      R         M   \n",
       "3       97403657.0         0.0  1.897316e+09 2018-04-07      R         M   \n",
       "4       97792860.0         0.0  1.917632e+09 2018-11-08      R         M   \n",
       "...            ...         ...           ...        ...    ...       ...   \n",
       "37822  117818518.0         0.0  2.684903e+09 2021-07-31      A         M   \n",
       "37823   37148629.0         0.0  2.684903e+09 2021-07-31      R         M   \n",
       "37824          NaN         NaN           NaN        NaT    NaN       NaN   \n",
       "37825          NaN         NaN           NaN        NaT    NaN       NaN   \n",
       "37826          NaN         NaN           NaN        NaT    NaN       NaN   \n",
       "\n",
       "      STATUS.1         USERID TRANSTYPE    RISK                 ATAS_RULE  \\\n",
       "0            H     HostJacobA         R  Medium       Blacklisted Country   \n",
       "1            H    HostAlvaroL         R  Medium  First Second Transaction   \n",
       "2            H   HostRobertaC         R  Medium     Closed Frozen Account   \n",
       "3            H    HostMarvinU         R  Medium  First Second Transaction   \n",
       "4            H     HostFabioS         R  Medium          Possible Hacking   \n",
       "...        ...            ...       ...     ...                       ...   \n",
       "37822        V  HostPranathiA         R  Medium          Country Mismatch   \n",
       "37823        R  HostPranathiA         R  Medium         Turnover Of Funds   \n",
       "37824      NaN            NaN       NaN     NaN                       NaN   \n",
       "37825      NaN            NaN       NaN     NaN                       NaN   \n",
       "37826      NaN            NaN       NaN     NaN                       NaN   \n",
       "\n",
       "                     Rule_Status  \n",
       "0           Blacklisted CountryR  \n",
       "1      First Second TransactionR  \n",
       "2         Closed Frozen AccountR  \n",
       "3      First Second TransactionR  \n",
       "4              Possible HackingR  \n",
       "...                          ...  \n",
       "37822          Country MismatchA  \n",
       "37823         Turnover Of FundsR  \n",
       "37824                        NaN  \n",
       "37825                        NaN  \n",
       "37826                        NaN  \n",
       "\n",
       "[37827 rows x 12 columns]>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ATAS_Alerts['Rule_Status'] = ATAS_Alerts['ATAS_RULE'] + ATAS_Alerts['STATUS']\n",
    "ATAS_Alerts.head(5)\n",
    "ATAS_Alerts.info\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "32d2ae91-ac32-436e-83e3-56f5e8cf94fe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                             USERINTID  VIP_STATUS  TRANSID  STARTED  STATUS  \\\n",
      "ATAS_RULE                                                                      \n",
      "-                                 7417        7417     7417     7417    7417   \n",
      "Blacklisted Country               1111        1111     1111     1111    1111   \n",
      "Blacklisted ISP                     13          13       13       13      13   \n",
      "Bonus Trackcode                     47          47       47       47      47   \n",
      "CSI Withdrawal Alerts              803         803      803      803     803   \n",
      "Cashout Cancelled                  375         375      375      375     375   \n",
      "Closed Frozen Account                1           1        1        1       1   \n",
      "Country Mismatch                  4637        4637     4637     4637    4637   \n",
      "Cumulative Transfer-In             334         334      334      334     334   \n",
      "Fast Withdrawal                     97          97       97       97      97   \n",
      "First Second Transaction          3586        3586     3586     3586    3586   \n",
      "GI Alert                           615         615      615      615     615   \n",
      "High Risk Player                  1859        1859     1859     1859    1859   \n",
      "Home Games                         919         919      919      919     919   \n",
      "KYC Score                            1           1        1        1       1   \n",
      "Last Transaction Comparison         42          42       42       42      42   \n",
      "Limits Tests                      1007        1007     1007     1007    1007   \n",
      "LtFPP Filter                         1           1        1        1       1   \n",
      "New Cashout Instrument            2820        2820     2820     2820    2820   \n",
      "New Player                        2711        2711     2711     2711    2711   \n",
      "No Rule Met                        330         330      330      330     330   \n",
      "Possible Hacking                     1           1        1        1       1   \n",
      "Safe Deposit                         1           1        1        1       1   \n",
      "Source Of Winnings                  39          39       39       39      39   \n",
      "Turnover Of Funds                 8404        8404     8404     8404    8404   \n",
      "Velocity Tests                     386         386      386      386     386   \n",
      "Win Rate                           266         266      266      266     266   \n",
      "Withdrawal With Dormancy             1           1        1        1       1   \n",
      "\n",
      "                             OLDSTATUS  STATUS.1  USERID  TRANSTYPE  RISK  \\\n",
      "ATAS_RULE                                                                   \n",
      "-                                 7417      7417    7417       7417  7417   \n",
      "Blacklisted Country               1111      1111    1111       1111  1111   \n",
      "Blacklisted ISP                     13        13      13         13    13   \n",
      "Bonus Trackcode                     47        47      47         47    47   \n",
      "CSI Withdrawal Alerts              803       803     803        803   803   \n",
      "Cashout Cancelled                  375       375     375        375   375   \n",
      "Closed Frozen Account                1         1       1          1     1   \n",
      "Country Mismatch                  4637      4637    4637       4637  4637   \n",
      "Cumulative Transfer-In             334       334     334        334   334   \n",
      "Fast Withdrawal                     97        97      97         97    97   \n",
      "First Second Transaction          3586      3586    3586       3586  3586   \n",
      "GI Alert                           615       615     615        615   615   \n",
      "High Risk Player                  1859      1859    1859       1859  1859   \n",
      "Home Games                         919       919     919        919   919   \n",
      "KYC Score                            1         1       1          1     1   \n",
      "Last Transaction Comparison         42        42      42         42    42   \n",
      "Limits Tests                      1007      1007    1007       1007  1007   \n",
      "LtFPP Filter                         1         1       1          1     1   \n",
      "New Cashout Instrument            2820      2820    2820       2820  2820   \n",
      "New Player                        2711      2711    2711       2711  2711   \n",
      "No Rule Met                        330       330     330        330   330   \n",
      "Possible Hacking                     1         1       1          1     1   \n",
      "Safe Deposit                         1         1       1          1     1   \n",
      "Source Of Winnings                  39        39      39         39    39   \n",
      "Turnover Of Funds                 8404      8404    8404       8404  8404   \n",
      "Velocity Tests                     386       386     386        386   386   \n",
      "Win Rate                           266       266     266        266   266   \n",
      "Withdrawal With Dormancy             1         1       1          1     1   \n",
      "\n",
      "                             Rule_Status  \n",
      "ATAS_RULE                                 \n",
      "-                                   7417  \n",
      "Blacklisted Country                 1111  \n",
      "Blacklisted ISP                       13  \n",
      "Bonus Trackcode                       47  \n",
      "CSI Withdrawal Alerts                803  \n",
      "Cashout Cancelled                    375  \n",
      "Closed Frozen Account                  1  \n",
      "Country Mismatch                    4637  \n",
      "Cumulative Transfer-In               334  \n",
      "Fast Withdrawal                       97  \n",
      "First Second Transaction            3586  \n",
      "GI Alert                             615  \n",
      "High Risk Player                    1859  \n",
      "Home Games                           919  \n",
      "KYC Score                              1  \n",
      "Last Transaction Comparison           42  \n",
      "Limits Tests                        1007  \n",
      "LtFPP Filter                           1  \n",
      "New Cashout Instrument              2820  \n",
      "New Player                          2711  \n",
      "No Rule Met                          330  \n",
      "Possible Hacking                       1  \n",
      "Safe Deposit                           1  \n",
      "Source Of Winnings                    39  \n",
      "Turnover Of Funds                   8404  \n",
      "Velocity Tests                       386  \n",
      "Win Rate                             266  \n",
      "Withdrawal With Dormancy               1  \n"
     ]
    }
   ],
   "source": [
    "Alerts_Per_Rule = ATAS_Alerts.groupby(['ATAS_RULE']).count()\n",
    "print(Alerts_Per_Rule)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "0d439806-a0cf-4aa3-a62a-8ce4a8f3c037",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "USERINTID      28962\n",
       "VIP_STATUS         1\n",
       "TRANSID        37822\n",
       "STARTED          247\n",
       "STATUS             4\n",
       "OLDSTATUS          1\n",
       "STATUS.1           3\n",
       "USERID           199\n",
       "TRANSTYPE          1\n",
       "RISK               2\n",
       "ATAS_RULE         28\n",
       "Rule_Status       88\n",
       "dtype: int64"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ATAS_Alerts.nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "261b3736-bbee-448d-9221-bb2b35467e92",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                           Rule AlertsPerRule\n",
      "0                             -          7417\n",
      "1           Blacklisted Country          1111\n",
      "2               Blacklisted ISP            13\n",
      "3               Bonus Trackcode            47\n",
      "4         CSI Withdrawal Alerts           803\n",
      "5             Cashout Cancelled           375\n",
      "6         Closed Frozen Account             1\n",
      "7              Country Mismatch          4637\n",
      "8        Cumulative Transfer-In           334\n",
      "9               Fast Withdrawal            97\n",
      "10     First Second Transaction          3586\n",
      "11                     GI Alert           615\n",
      "12             High Risk Player          1859\n",
      "13                   Home Games           919\n",
      "14                    KYC Score             1\n",
      "15  Last Transaction Comparison            42\n",
      "16                 Limits Tests          1007\n",
      "17                 LtFPP Filter             1\n",
      "18       New Cashout Instrument          2820\n",
      "19                   New Player          2711\n",
      "20                  No Rule Met           330\n",
      "21             Possible Hacking             1\n",
      "22                 Safe Deposit             1\n",
      "23           Source Of Winnings            39\n",
      "24            Turnover Of Funds          8404\n",
      "25               Velocity Tests           386\n",
      "26                     Win Rate           266\n",
      "27     Withdrawal With Dormancy             1\n"
     ]
    }
   ],
   "source": [
    "Count_Alerts = pd.DataFrame({'Rule' : ['-', 'Blacklisted Country', 'Blacklisted ISP', 'Bonus Trackcode',\n",
    "                                       'CSI Withdrawal Alerts', 'Cashout Cancelled', 'Closed Frozen Account', \n",
    "                                       'Country Mismatch', 'Cumulative Transfer-In', 'Fast Withdrawal', \n",
    "                                       'First Second Transaction', 'GI Alert','High Risk Player', 'Home Games', 'KYC Score', \n",
    "                                       'Last Transaction Comparison', 'Limits Tests', 'LtFPP Filter', 'New Cashout Instrument', \n",
    "                                       'New Player', 'No Rule Met', 'Possible Hacking', 'Safe Deposit', 'Source Of Winnings', \n",
    "                                       'Turnover Of Funds', 'Velocity Tests', 'Win Rate', 'Withdrawal With Dormancy' ],\n",
    "                            'AlertsPerRule' : ['7417', '1111', '13', '47', '803', '375', '1', '4637', \n",
    "                             '334', '97', '3586', '615', '1859', '919', '1', '42', '1007', \n",
    "                             '1', '2820', '2711', '330', '1', '1', '39', '8404', '386', '266', '1']})\n",
    "print(Count_Alerts)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "2af7e1c1-dae9-4eb5-9e03-733bdb98414d",
   "metadata": {},
   "outputs": [],
   "source": [
    "CountRules = ATAS_Alerts['ATAS_RULE'].value_counts()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "0e7b05ad-7e7b-4e43-ba57-10dca081a3e2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Index: 28 entries, Turnover Of Funds to LtFPP Filter\n",
      "Data columns (total 1 columns):\n",
      " #   Column  Non-Null Count  Dtype\n",
      "---  ------  --------------  -----\n",
      " 0   Rules   28 non-null     int64\n",
      "dtypes: int64(1)\n",
      "memory usage: 448.0+ bytes\n"
     ]
    }
   ],
   "source": [
    "Total_Rules = ATAS_Alerts['Rule_Status'].value_counts()\n",
    "AlertsPerRule = { 'Rules' : CountRules }\n",
    "AlertsPerRule = pd.DataFrame(AlertsPerRule).info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b839fff2-10e4-4c2f-ada9-fb0235b528fa",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1b76be2-0093-430e-a02c-127335863926",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "321924a7-299e-4e28-8482-045cfa07adeb",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
